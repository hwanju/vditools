#!/usr/bin/stap -v

global lock_holder

probe module("kvm").function("get_lock_holder_eip").return {
        lh_eip = $return;
        lock_holder[lh_eip, $caller_info]++
}

probe end {
        foreach ([eip, caller_info] in lock_holder-) {
                printf ("%x\t%d\t%x\n", eip, lock_holder[eip, caller_info], caller_info)
        }
}
